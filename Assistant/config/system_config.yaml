# System Configuration - Centralized configuration for tools, tables, and mappings
# This file contains all previously hardcoded values for easy maintenance

# Tool Categories
tools:
  # SQL-based tools (database access)
  sql_tools:
    - sales_db
    - meta_ads_db
    - google_ads_db
    - organic_db
  
  # API-based tools
  api_tools: []
  
  # Compute tools
  compute_tools:
    - compute
  
  # Excluded/disabled tools (patterns to skip)
  excluded_patterns:
    - amazon
  
  # Tools that need date range enhancement
  date_range_tools:
    - sales_db
    - meta_ads_db
    - google_ads_db
    - organic_db

# Table Mappings
tables:
  # Common fallback tables (used when no relevant tables found)
  common_fallback:
    - public.shopify_orders
    - public.dw_meta_ads_attribution
  
  # Table name corrections (generic names -> actual table names)
  name_corrections:
    orders: public.shopify_orders
    order: public.shopify_orders
    sales: public.shopify_orders
    products: public.shopify_product_variants
    product: public.shopify_product_variants
    meta_ads: public.dw_meta_ads_attribution
    google_ads: public.dw_google_ads_attribution
  
  # Excluded table patterns
  excluded_patterns:
    - amazon_ads
    - amazon_product_metrics_daily
    - amazon_product_metrics
  
  # SQL table name corrections (regex patterns for auto-correction)
  sql_corrections:
    - pattern: \bFROM\s+orders\b
      replacement: FROM public.shopify_orders
    - pattern: \bFROM\s+order\b
      replacement: FROM public.shopify_orders
    - pattern: \bFROM\s+sales\b
      replacement: FROM public.shopify_orders
    - pattern: \bJOIN\s+orders\b
      replacement: JOIN public.shopify_orders
    - pattern: \bJOIN\s+order\b
      replacement: JOIN public.shopify_orders
    - pattern: \bJOIN\s+sales\b
      replacement: JOIN public.shopify_orders
    - pattern: \bFROM\s+products\b
      replacement: FROM public.shopify_product_variants
    - pattern: \bJOIN\s+products\b
      replacement: JOIN public.shopify_product_variants
    - pattern: \bFROM\s+meta_ads\b
      replacement: FROM public.dw_meta_ads_attribution
    - pattern: \bJOIN\s+meta_ads\b
      replacement: JOIN public.dw_meta_ads_attribution
  
  # SQL column name corrections (common mistakes)
  column_corrections:
    # Date column corrections - order_date should be created_at
    - pattern: \bo\.order_date\b
      replacement: o.created_at
      description: "order_date does not exist in shopify_orders - use created_at"
    - pattern: \border_date\b
      replacement: created_at
      description: "order_date does not exist - use created_at for shopify_orders (without table alias)"
    - pattern: \b([a-zA-Z_][a-zA-Z0-9_]*\.)?order_date\b
      replacement: \1created_at
      description: "order_date does not exist - use created_at for shopify_orders"
    # Product ID corrections for order_line_items
    - pattern: \boli\.product_id\b
      replacement: pv.product_id
      description: "product_id does not exist in shopify_order_line_items - JOIN with shopify_product_variants first"
    - pattern: \border_line_items\.product_id\b
      replacement: shopify_product_variants.product_id
      description: "product_id does not exist in shopify_order_line_items"

# Metric to Table Mappings
# Used by schema context service to find relevant tables for queries
metric_table_mappings:
  revenue:
    - shopify_orders
    - dw_meta_ads_attribution
    - dw_google_ads_attribution
  spend:
    - dw_meta_ads_attribution
    - dw_google_ads_attribution
  orders:
    - shopify_orders
  campaign:
    - dw_meta_ads_attribution
    - dw_google_ads_attribution
  product:
    - shopify_product_variants
    - shopify_order_line_items
  ads:
    - dw_meta_ads_attribution
    - dw_google_ads_attribution
  meta:
    - dw_meta_ads_attribution
  google:
    - dw_google_ads_attribution

# Tool-specific table mappings
# Maps tool IDs to their primary tables (used by data access agents)
tool_table_mappings:
  sales_db:
    primary_table: public.shopify_orders
    date_column: created_at
  meta_ads_db:
    primary_table: public.dw_meta_ads_attribution
    date_column: date_start
  google_ads_db:
    primary_table: public.dw_google_ads_attribution
    date_column: date_start

# System Messages
messages:
  amazon_disabled: "Amazon operations are not available. Tool '{tool_id}' is disabled."
  amazon_table_disabled: "Amazon operations are not available. Table '{table}' is disabled. Please use alternative data sources like Meta Ads or Google Ads."
  invalid_tool_format: "Invalid tool format in step {step_id}: {tool}. Tools must be in format 'tool_id.capability_name'"
  sql_tool_format: "SQL tools must be in format 'tool_id.capability' (e.g., '{suggested_format}')"
  compute_tool_format: "Compute tools must be in format 'compute.capability' (e.g., 'compute.aggregate', 'compute.join', 'compute.calculate')"

